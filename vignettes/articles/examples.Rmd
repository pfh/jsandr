---
title: "Examples"
---

## Crosstalk and Javascript

Here I demonstrate:

* `let()` and `let1()` to send data to Javascript.
* `talkToPlotly()` to tweak plotly-crosstalk interaction.
* Accessing a crosstalk selection from Javascript.
* Laying out widgets using a `display: grid` styled div.

First create some widgets:

```{r warning=FALSE,message=FALSE}
library(crosstalk)
library(htmltools)
library(plotly)
library(tidyverse)
library(GGally)
library(geozoo)
library(langevitour)
library(jsandr)

df <- as.data.frame(conic.spiral.nautilus(n=5000, b=1)$points)
shared <- SharedData$new(df)

p1 <- ggplot(shared)+aes(x=V2,y=V1)+geom_point()
p2 <- ggplot(shared)+aes(x=V2,y=V3)+geom_point()

# Convert ggplot to plotly with talkToPlotly (with some tweaks compared to ggplotly)
w1 <- talkToPlotly(p1, width="400", height="400")
w2 <- talkToPlotly(p2, width="400", height="400")

wLangevitour <- langevitour(df, link=shared, pointSize=2, width="500", height="600")

# Tell Javascript the crosstalk group name.
let1(groupName = shared$groupName())
```

Javascript code:

```{js}
let handle = new crosstalk.SelectionHandle();
handle.setGroup(groupName);

function update() {
    document.getElementById("out").innerText = 'Javascript says: You\'ve selected '+(handle.value||[]).length+' points.';
}

handle.on("change", update);
window.addEventListener("load", update);
```

Show the widgets, and provide an output element for the Javascript:

```{r}
browsable(div(
    style="display: grid; grid-template-columns: 0fr 1fr;",
    w1,            w2,
    wLangevitour,  div(id="out")
    ))
```

